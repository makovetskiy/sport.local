Vue.http.headers.common["X-CSRF-TOKEN"]=$("#token").attr("value"),Vue.directive("tinymce-editor",{twoWay:!0,bind:function(){var t=this;tinymce.init({selector:"#editor",language:"ru",height:300,fontsize_formats:"8pt 10pt 12pt 14pt 18pt 24pt 36pt",plugins:["advlist autolink lists link image charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime media nonbreaking save table contextmenu directionality","emoticons template paste textcolor colorpicker textpattern"],toolbar:"insertfile undo redo | sizeselect | fontsizeselect | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media",setup:function(i){i.on("init",function(){tinymce.get("editor").setContent(t.value)}),i.on("keyup",function(){var i=tinymce.get("editor").getContent(t.value);t.set(i)}),i.on("mouseout",function(){var i=tinymce.get("editor").getContent(t.value);t.set(i)})}})},update:function(t,i){$(this.el).val(t).trigger("keyup")}});var sportmanager=new Vue({el:"#sport-manager",data:{starts:[],pagination:{total:0,per_page:2,from:1,to:0,current_page:1},offset:4,image:"",tmc:"",formErrorsUpdate:"",fillItem:{id:"",title:"",description:"",date:"2012-05-15",time:"",photo:""}},computed:{isActived:function(){return this.pagination.current_page},pagesNumber:function(){if(!this.pagination.to)return[];var t=this.pagination.current_page-this.offset;t<1&&(t=1);var i=t+2*this.offset;i>=this.pagination.last_page&&(i=this.pagination.last_page);for(var e=[];t<=i;)e.push(t),t++;return e}},methods:{getStarts:function(t){this.$http.get("/start?page="+t).then(function(t){this.starts=t.data.data.data,this.$set("pagination",t.data.pagination),this.formErrorsUpdate=""})},editStart:function(t){this.fillItem.title=t.title,this.fillItem.id=t.id,this.fillItem.date=t.date,this.fillItem.time=t.time,this.fillItem.photo=t.photo,this.fillItem.description=t.description,this.tmc=t.description,tinymce.get("editor").setContent(this.tmc)},deleteStart:function(t){this.$http.delete("/start/"+t).then(function(t){this.changePage(this.pagination.current_page),this.fillItem={id:"",title:"",description:"",date:"2012-05-15",time:"",photo:""},toastr.warning("ЗАпись удалена.","Внимание!",{timeOut:5e3}),this.tmc="",tinymce.get("editor").setContent(this.tmc)})},createStart:function(t){this.changePage(this.pagination.current_page),this.fillItem={id:"",title:"",description:"",date:"2012-05-15",time:"",photo:""},this.tmc="",tinymce.get("editor").setContent(this.tmc)},updateStart:function(t){if(t){var i=this.fillItem;this.$http.put("/start/"+t,i).then(function(t){this.changePage(this.pagination.current_page),this.fillItem={id:"",title:"",description:"",date:"2012-05-15",time:"",photo:""},toastr.success("Запись успешно сохранена.","Обновление!",{timeOut:5e3}),this.tmc="",tinymce.get("editor").setContent(this.tmc)},function(t){this.formErrorsUpdate=t.data,toastr.error(this.formErrorsUpdate,"Ошибка!",{timeOut:5e3})})}else{var i=this.fillItem;this.$http.post("/start",i).then(function(t){this.changePage(this.pagination.current_page),this.fillItem={id:"",title:"",description:"",date:"2012-05-15",time:"",photo:""},toastr.success("Запись успешно сохранена.","Обновление!",{timeOut:5e3}),this.tmc="",tinymce.get("editor").setContent(this.tmc)},function(t){this.formErrorsUpdate=t.data,toastr.error(this.formErrorsUpdate,"Ошибка!",{timeOut:5e3})})}},changePage:function(t){this.pagination.current_page=t,this.getStarts(t)}},ready:function(){this.getStarts(this.pagination.current_page),$("#datepicker").bootstrapMaterialDatePicker({format:"YYYY-MM-DD",lang:"ru",weekStart:1,cancelText:"Отмена",nowButton:!0,switchOnClick:!0,time:!1}),$("#time").bootstrapMaterialDatePicker({date:!1,shortTime:!1,format:"HH:mm"});$("#filer_input").filer({limit:1,maxSize:null,extensions:["jpg","png","gif"],changeInput:'<div class="jFiler-input-dragDrop"><div class="jFiler-input-inner"><div class="jFiler-input-icon"><i class="icon-jfi-cloud-up-o"></i></div><div class="jFiler-input-text"><h3>Перетяните сюда изображения</h3> <span style="display:inline-block; margin: 15px 0">или</span></div><a class="jFiler-input-choose-btn blue">Выберите его</a></div></div>',showThumbs:!1,theme:"dragdropbox",templates:{box:'<ul class="jFiler-items-list jFiler-items-grid"></ul>',item:'<li class="jFiler-item">\t\t\t\t\t\t<div class="jFiler-item-container">\t\t\t\t\t\t\t<div class="jFiler-item-inner">\t\t\t\t\t\t\t\t<div class="jFiler-item-thumb">\t\t\t\t\t\t\t\t\t<div class="jFiler-item-status"></div>\t\t\t\t\t\t\t\t\t<div class="jFiler-item-thumb-overlay">\t\t\t\t\t\t\t\t\t\t<div class="jFiler-item-info">\t\t\t\t\t\t\t\t\t\t\t<div style="display:table-cell;vertical-align: middle;">\t\t\t\t\t\t\t\t\t\t\t\t<span class="jFiler-item-title"><b title="{{fi-name}}">{{fi-name}}</b></span>\t\t\t\t\t\t\t\t\t\t\t\t<span class="jFiler-item-others">{{fi-size2}}</span>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t{{fi-image}}\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="jFiler-item-assets jFiler-row">\t\t\t\t\t\t\t\t\t<ul class="list-inline pull-left">\t\t\t\t\t\t\t\t\t\t<li>{{fi-progressBar}}</li>\t\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t\t\t<ul class="list-inline pull-right">\t\t\t\t\t\t\t\t\t\t<li><a class="icon-jfi-trash jFiler-item-trash-action"></a></li>\t\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</li>',itemAppend:'<li class="jFiler-item">\t\t\t\t\t\t\t<div class="jFiler-item-container">\t\t\t\t\t\t\t\t<div class="jFiler-item-inner">\t\t\t\t\t\t\t\t\t<div class="jFiler-item-thumb">\t\t\t\t\t\t\t\t\t\t<div class="jFiler-item-status"></div>\t\t\t\t\t\t\t\t\t\t<div class="jFiler-item-thumb-overlay">\t\t\t\t\t\t\t\t\t\t\t<div class="jFiler-item-info">\t\t\t\t\t\t\t\t\t\t\t\t<div style="display:table-cell;vertical-align: middle;">\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="jFiler-item-title"><b title="{{fi-name}}">{{fi-name}}</b></span>\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="jFiler-item-others">{{fi-size2}}</span>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t{{fi-image}}\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="jFiler-item-assets jFiler-row">\t\t\t\t\t\t\t\t\t\t<ul class="list-inline pull-left">\t\t\t\t\t\t\t\t\t\t\t<li><span class="jFiler-item-others">{{fi-icon}}</span></li>\t\t\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t\t\t\t<ul class="list-inline pull-right">\t\t\t\t\t\t\t\t\t\t\t<li><a class="icon-jfi-trash jFiler-item-trash-action"></a></li>\t\t\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</li>',progressBar:'<div class="bar"></div>',itemAppendToEnd:!1,canvasImage:!0,removeConfirmation:!0,_selectors:{list:".jFiler-items-list",item:".jFiler-item",progressBar:".bar",remove:".jFiler-item-trash-action"}},dragDrop:{dragEnter:null,dragLeave:null,drop:null,dragContainer:null},uploadFile:{url:"/upload",data:{_token:window.laravel},type:"POST",enctype:"multipart/form-data",synchron:!0,beforeSend:function(){},success:function(t,i,e,s,a,l,n){var r=i.find(".jFiler-jProgressBar").parent(),o=JSON.parse(t),c=l.prop("jFiler");sportmanager.fillItem.photo="images/"+o,c.files_list[n].name=o,i.find(".jFiler-jProgressBar").fadeOut("slow",function(){$('<div class="jFiler-item-others text-success"><i class="icon-jfi-check-circle"></i> Success</div>').hide().appendTo(r).fadeIn("slow")}),c.reset()},error:function(t){var i=t.find(".jFiler-jProgressBar").parent();t.find(".jFiler-jProgressBar").fadeOut("slow",function(){$('<div class="jFiler-item-others text-error"><i class="icon-jfi-minus-circle"></i> Error</div>').hide().appendTo(i).fadeIn("slow")})},statusCode:null,onProgress:null,onComplete:null},files:null,addMore:!1,allowDuplicates:!0,clipBoardPaste:!0,excludeName:null,beforeRender:null,afterRender:null,beforeShow:null,beforeSelect:null,onSelect:null,afterShow:null,onRemove:function(t,i,e,s,a,l,n){var r=n.prop("jFiler"),o=r.files_list[e].name;$.post("/remove",{file:o})},onEmpty:null,options:null,dialogs:{alert:function(t){return alert(t)},confirm:function(t,i){confirm(t)?i():null}},captions:{button:"Выберите изображение",feedback:"Выберите изображение",feedback2:"files were chosen",drop:"Перетяните изображение для загрузки",removeConfirmation:"Вы уверены, что хотите удалить файл?",errors:{filesLimit:"Только {{fi-limit}} файл может быть загружен.",filesType:"Только изображения.",filesSize:"{{fi-name}} слишком больной! размер не должен превышать {{fi-maxSize}} MB.",filesSizeAll:"Files you've choosed are too large! Please upload files up to {{fi-maxSize}} MB."}}})}});